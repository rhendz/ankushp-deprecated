!function(){var t={columns:0,rows:0,maxCells:1e4,waitTime:0,generation:0,running:!1,autoplay:!0,clear:{schedule:!1},times:{algorithm:0,gui:0},element:{generation:null,steptime:null,livecells:null,hint:null},grid:{current:0,schemes:[{color:"#F3F3F3"},{color:"#FFFFFF"},{color:"#666666"},{color:""}]},zoom:{current:0,schedule:!1,schemes:[{columns:180,rows:86,cellSize:8},{columns:300,rows:144,cellSize:2},{columns:450,rows:216,cellSize:1}]},colors:{current:0,schedule:!1,schemes:[{dead:"#FFFFFF",alive:["#95E0A2","#40C463","#30A14E"]},{dead:"#FFFFFF",alive:["#FF0000","#FF7F00","#FFFF00","#008000 ","#0000FF","#4B0082","#EE82EE"]},{dead:"#FFFFFF",alive:["#000000"]}]},init:function(){try{window.addEventListener("resize",function(){t.cleanUp(),t.init()}),this.listLife.init(),this.loadConfig(),this.loadState(),this.canvas.init(),this.prepare()}catch(t){alert("Error: "+t)}},loadConfig:function(){var e,i,s;this.autoplay=t.autoplay,e=parseInt(1),(isNaN(e)||e<1||e>t.colors.schemes.length)&&(e=1),i=parseInt(4),(isNaN(i)||i<1||i>t.grid.schemes.length)&&(i=1),s=parseInt(1),(isNaN(s)||s<1||s>t.zoom.schemes.length)&&(s=1),this.colors.current=e-1,this.grid.current=i-1,this.zoom.current=s-1;var l=document.getElementById("gol");t.columns=l.scrollWidth,t.rows=l.scrollHeight;for(var n=1;t.columns*t.rows/n>t.maxCells;)t.columns/=2,t.rows/=2,n*=2;this.zoom.schemes[this.zoom.current].rows=t.rows,this.zoom.schemes[this.zoom.current].columns=t.columns,this.zoom.schemes[this.zoom.current].cellSize=n,this.rows=this.zoom.schemes[this.zoom.current].rows,this.columns=this.zoom.schemes[this.zoom.current].columns},loadState:function(){this.randomState()},randomState:function(){var t,e=this.rows*this.columns*.12;for(t=0;t<e;t++)this.listLife.addCell(this.helpers.random(0,this.columns-1),this.helpers.random(0,this.rows-1),this.listLife.actualState);this.listLife.nextGeneration()},cleanUp:function(){this.listLife.init(),this.prepare()},prepare:function(){this.generation=this.times.algorithm=this.times.gui=0,this.mouseDown=this.clear.schedule=!1,this.canvas.clearWorld(),this.canvas.drawWorld(),this.autoplay&&(this.autoplay=!1,this.handlers.buttons.run())},nextStep:function(){var e,i,s,l,n,o;for(n=new Date,t.listLife.nextGeneration(),n=new Date-n,o=new Date,e=0;e<t.listLife.redrawList.length;e++)i=t.listLife.redrawList[e][0],s=t.listLife.redrawList[e][1],1===t.listLife.redrawList[e][2]?t.canvas.changeCelltoAlive(i,s):2===t.listLife.redrawList[e][2]?t.canvas.keepCellAlive(i,s):t.canvas.changeCelltoDead(i,s);if(o=new Date-o,t.grid.schedule&&(t.grid.schedule=!1,t.canvas.drawWorld()),t.colors.schedule&&(t.colors.schedule=!1,t.canvas.drawWorld()),t.generation++,l=1/t.generation,t.times.algorithm=t.times.algorithm*(1-l)+n*l,t.times.gui=t.times.gui*(1-l)+o*l,t.running){function a(){window.requestAnimationFrame(t.nextStep)}t.waitTime>0?setTimeout(function(){a()},t.waitTime):a()}else t.clear.schedule&&t.cleanUp()},handlers:{lastX:0,lastY:0,canvasMouseMove:function(e){var i=t.helpers.mousePosition(e);i[0]===t.handlers.lastX&&i[1]===t.handlers.lastY||(t.canvas.switchCell(i[0],i[1]),t.handlers.lastX=i[0],t.handlers.lastY=i[1])},buttons:{run:function(){t.running=!t.running,t.running&&t.nextStep()},step:function(){t.running||t.nextStep()},clear:function(){t.running?(t.clear.schedule=!0,t.running=!1):t.cleanUp()},colors:function(){t.colors.current=(t.colors.current+1)%t.colors.schemes.length,t.running?t.colors.schedule=!0:t.canvas.drawWorld()},grid:function(){t.grid.current=(t.grid.current+1)%t.grid.schemes.length,t.running?t.grid.schedule=!0:t.canvas.drawWorld()}}},canvas:{context:null,width:null,height:null,age:null,cellSize:null,cellSpace:null,init:function(){this.canvas=document.getElementById("gol"),this.context=this.canvas.getContext("2d"),this.cellSize=t.zoom.schemes[t.zoom.current].cellSize,this.cellSpace=1,t.helpers.registerEvent(document,"mousemove",t.handlers.canvasMouseMove,!1),this.clearWorld()},clearWorld:function(){var e,i;for(this.age=[],e=0;e<t.columns;e++)for(this.age[e]=[],i=0;i<t.rows;i++)this.age[e][i]=0},drawWorld:function(){var e,i;for(""===t.grid.schemes[t.grid.current].color?(this.setNoGridOn(),this.width=this.height=0):(this.setNoGridOff(),this.width=this.height=1),this.width=this.width+this.cellSpace*t.columns+this.cellSize*t.columns,this.canvas.setAttribute("width",this.canvas.scrollWidth),this.height=this.height+this.cellSpace*t.rows+this.cellSize*t.rows,this.canvas.setAttribute("height",this.canvas.scrollHeight),e=0;e<t.columns;e++)for(i=0;i<t.rows;i++)t.listLife.isAlive(e,i)?this.drawCell(e,i,!0):this.drawCell(e,i,!1)},setNoGridOn:function(){this.cellSize=t.zoom.schemes[t.zoom.current].cellSize+1,this.cellSpace=0},setNoGridOff:function(){this.cellSize=t.zoom.schemes[t.zoom.current].cellSize,this.cellSpace=1},drawCell:function(e,i,s){s?this.age[e][i]>-1&&(this.context.fillStyle=t.colors.schemes[t.colors.current].alive[this.age[e][i]%t.colors.schemes[t.colors.current].alive.length],this.context.fillRect(this.cellSpace+this.cellSpace*e+this.cellSize*e,this.cellSpace+this.cellSpace*i+this.cellSize*i,this.cellSize,this.cellSize)):this.context.clearRect(this.cellSpace+this.cellSpace*e+this.cellSize*e,this.cellSpace+this.cellSpace*i+this.cellSize*i,this.cellSize,this.cellSize)},switchCell:function(e,i){t.listLife.isAlive(e,i)?(this.changeCelltoDead(e,i),t.listLife.removeCell(e,i,t.listLife.actualState)):(this.changeCelltoAlive(e,i),t.listLife.addCell(e,i,t.listLife.actualState))},keepCellAlive:function(e,i){e>=0&&e<t.columns&&i>=0&&i<t.rows&&(this.age[e][i]++,this.drawCell(e,i,!0))},changeCelltoAlive:function(e,i){e>=0&&e<t.columns&&i>=0&&i<t.rows&&(this.age[e][i]=1,this.drawCell(e,i,!0))},changeCelltoDead:function(e,i){e>=0&&e<t.columns&&i>=0&&i<t.rows&&this.drawCell(e,i,!1)}},listLife:{actualState:[],redrawList:[],init:function(){this.actualState=[]},nextGeneration:function(){var t,e,i,s,l,n,o,a,r,c,h=0,u={},d=[];for(this.redrawList=[],i=0;i<this.actualState.length;i++)for(this.topPointer=1,this.bottomPointer=1,s=1;s<this.actualState[i].length;s++){for(c=[[(t=this.actualState[i][s])-1,(e=this.actualState[i][0])-1,1],[t,e-1,1],[t+1,e-1,1],[t-1,e,1],[t+1,e,1],[t-1,e+1,1],[t,e+1,1],[t+1,e+1,1]],r=this.getNeighboursFromAlive(t,e,i,c),l=0;l<8;l++)void 0!==c[l]&&(void 0===u[n=c[l][0]+","+c[l][1]]?u[n]=1:u[n]++);0===r||1===r||r>3?this.redrawList.push([t,e,0]):(this.addCell(t,e,d),h++,this.redrawList.push([t,e,2]))}for(n in u)3===u[n]&&(n=n.split(","),o=parseInt(n[0],10),a=parseInt(n[1],10),this.addCell(o,a,d),h++,this.redrawList.push([o,a,1]));return this.actualState=d,h},topPointer:1,middlePointer:1,bottomPointer:1,getNeighboursFromAlive:function(t,e,i,s){var l,n=0;if(void 0!==this.actualState[i-1]&&this.actualState[i-1][0]===e-1)for(l=this.topPointer;l<this.actualState[i-1].length&&!(this.actualState[i-1][l]>=t-1&&(this.actualState[i-1][l]===t-1&&(s[0]=void 0,this.topPointer=l+1,n++),this.actualState[i-1][l]===t&&(s[1]=void 0,this.topPointer=l,n++),this.actualState[i-1][l]===t+1&&(s[2]=void 0,this.topPointer=1==l?1:l-1,n++),this.actualState[i-1][l]>t+1));l++);for(l=1;l<this.actualState[i].length&&!(this.actualState[i][l]>=t-1&&(this.actualState[i][l]===t-1&&(s[3]=void 0,n++),this.actualState[i][l]===t+1&&(s[4]=void 0,n++),this.actualState[i][l]>t+1));l++);if(void 0!==this.actualState[i+1]&&this.actualState[i+1][0]===e+1)for(l=this.bottomPointer;l<this.actualState[i+1].length&&!(this.actualState[i+1][l]>=t-1&&(this.actualState[i+1][l]===t-1&&(s[5]=void 0,this.bottomPointer=l+1,n++),this.actualState[i+1][l]===t&&(s[6]=void 0,this.bottomPointer=l,n++),this.actualState[i+1][l]===t+1&&(s[7]=void 0,this.bottomPointer=1==l?1:l-1,n++),this.actualState[i+1][l]>t+1));l++);return n},isAlive:function(t,e){var i,s;for(i=0;i<this.actualState.length;i++)if(this.actualState[i][0]===e)for(s=1;s<this.actualState[i].length;s++)if(this.actualState[i][s]===t)return!0;return!1},removeCell:function(t,e,i){var s,l;for(s=0;s<i.length;s++)if(i[s][0]===e)if(2===i[s].length)i.splice(s,1);else for(l=1;l<i[s].length;l++)i[s][l]===t&&i[s].splice(l,1)},addCell:function(t,e,i){if(0!==i.length){var s,l,n,o,a,r=[];if(e<i[0][0]){for(r=[[e,t]],s=0;s<i.length;s++)r[s+1]=i[s];for(s=0;s<r.length;s++)i[s]=r[s]}else if(e>i[i.length-1][0])i[i.length]=[e,t];else for(l=0;l<i.length;l++){if(i[l][0]===e){for(o=[],a=!1,n=1;n<i[l].length;n++)!a&&t<i[l][n]&&(o.push(t),a=!a),o.push(i[l][n]);return o.unshift(e),a||o.push(t),void(i[l]=o)}if(e<i[l][0]){for(r=[],s=0;s<i.length;s++)s===l?(r[s]=[e,t],r[s+1]=i[s]):s<l?r[s]=i[s]:s>l&&(r[s+1]=i[s]);for(s=0;s<r.length;s++)i[s]=r[s];return}}}else i.push([e,t])}},helpers:{urlParameters:null,random:function(t,e){return t<=e?t+Math.round(Math.random()*(e-t)):null},registerEvent:function(t,e,i,s){/msie/i.test(navigator.userAgent)?t.attachEvent("on"+e,i):t.addEventListener(e,i,s)},mousePosition:function(e){var i,s,l=0,n=0,o=0,a=0,r=t.zoom.schemes[t.zoom.current].cellSize+1;for((i=e)||(i=window.event),i.pageX||i.pageY?(l=i.pageX,n=i.pageY):(i.clientX||i.clientY)&&(l=i.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=i.clientY+document.body.scrollTop+document.documentElement.scrollTop),s=i.target||i.srcElement;s.offsetParent;)a+=s.offsetLeft,o+=s.offsetTop,s=s.offsetParent;return s.pageTop=o,s.pageLeft=a,[Math.ceil((l-s.pageLeft)/r-1),Math.ceil((n-s.pageTop)/r-1)]}}};t.helpers.registerEvent(window,"load",function(){t.init()},!1)}();